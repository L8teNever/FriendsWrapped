<!DOCTYPE html>
<html lang="de" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{{ config.get('page_title', 'Unsere Story | Friendship Wrapped') }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');

        /* Scroll Snapping */
        html {
            scroll-snap-type: y mandatory;
            height: 100%;
            background-color: #000;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: white;
            overflow-x: hidden;
            height: 100%;
            margin: 0;
            background-color: #000;
        }

        /* Spotify Grain/Noise Effect */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://grainy-gradients.vercel.app/noise.svg');
            opacity: 0.15;
            pointer-events: none;
            z-index: 50;
        }

        section {
            scroll-snap-align: start;
            scroll-snap-stop: always;
            min-height: 100dvh;
            width: 100%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 80px 0;
            /* Space for dividers */
        }

        @media (min-width: 768px) {
            section {
                padding: 120px 0;
            }
        }

        /* Animated Background Blobs */
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            z-index: 1;
            opacity: 0.4;
            animation: move 25s infinite alternate ease-in-out;
        }

        @keyframes move {
            0% {
                transform: translate(-20%, -20%) scale(1) rotate(0deg);
            }

            50% {
                transform: translate(10%, 15%) scale(1.3) rotate(90deg);
            }

            100% {
                transform: translate(25%, -10%) scale(1.1) rotate(180deg);
            }
        }

        /* Floating Background Text/Numbers */
        .bg-floating-text {
            position: absolute;
            font-size: 40dvh;
            font-weight: 900;
            color: rgba(255, 255, 255, 0.03);
            z-index: 0;
            pointer-events: none;
            white-space: nowrap;
            line-height: 1;
            animation: float-text 15s infinite alternate ease-in-out;
        }

        @keyframes float-text {
            from {
                transform: translate(-5%, -5%) rotate(-5deg);
            }

            to {
                transform: translate(5%, 5%) rotate(5deg);
            }
        }

        @keyframes float-around {
            0% {
                transform: translate(0, 0) rotate(0deg);
            }

            33% {
                transform: translate(30px, -50px) rotate(10deg);
            }

            66% {
                transform: translate(-20px, 20px) rotate(-10deg);
            }

            100% {
                transform: translate(0, 0) rotate(0deg);
            }
        }

        .floating-number {
            position: absolute;
            font-weight: 900;
            color: white;
            opacity: 0.1;
            pointer-events: none;
            z-index: 1;
            filter: blur(2px);
            animation: float-around 15s infinite ease-in-out;
        }

        .birthday-stagger {
            opacity: 0;
            transition: opacity 1s ease-out;
        }

        section.active .birthday-stagger {
            opacity: 0.15;
        }

        /* Gradient Shift Animation */
        .gradient-animate {
            background-size: 200% 200%;
            animation: gradient-shift 10s infinite alternate ease-in-out;
        }

        @keyframes gradient-shift {
            0% {
                background-position: 0% 50%;
            }

            100% {
                background-position: 100% 50%;
            }
        }

        /* Gradients - Vertical for seamless dividers */
        .wrapped-gradient-1 {
            background: linear-gradient(to bottom, #1db954, #191414);
        }

        .wrapped-gradient-birthday {
            background: linear-gradient(to bottom, #8e2de2, #4a00e0);
        }

        .wrapped-gradient-stats {
            background: linear-gradient(to bottom, #ff416c, #ff4b2b);
        }

        .wrapped-gradient-chat {
            background: linear-gradient(to bottom, #00b4db, #0083b0);
        }

        .wrapped-gradient-thennow {
            background: linear-gradient(to bottom, #2af598, #009efd);
        }

        .wrapped-gradient-funny {
            background: linear-gradient(to bottom, #FFD200, #F7971E);
        }

        .wrapped-gradient-music {
            background: linear-gradient(to bottom, #4facfe, #00f2fe);
        }

        .wrapped-gradient-future {
            background: linear-gradient(to bottom, #667eea, #764ba2);
        }

        .wrapped-gradient-profile {
            background: linear-gradient(to bottom, #f953c6, #b91d73);
        }

        .wrapped-gradient-4 {
            background: #f093fb;
        }

        /* Fancy Reveal Animations */
        .reveal {
            opacity: 0;
            transform: translateY(40px) scale(0.9);
            transition: all 0.8s cubic-bezier(0.17, 0.55, 0.55, 1);
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        /* Staggered Children Delay (Generated up to 20 levels) */
            {
            % for i in range(1, 21) %
        }

        .stagger- {
                {
                i
            }
        }

            {
            transition-delay: {
                    {
                    0.1 * i
                }
            }

            s !important;
        }

            {
            % endfor %
        }

        /* General Reveal Items for Lists */
        .reveal-item {
            opacity: 0;
            transform: translateY(30px) scale(0.9);
            transition: all 0.7s cubic-bezier(0.17, 0.55, 0.55, 1);
        }

        .reveal.active .reveal-item {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .swipe-container {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            width: 100%;
        }

        .swipe-container::-webkit-scrollbar {
            display: none;
        }

        .swipe-item {
            flex-shrink: 0;
            width: 100%;
            scroll-snap-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 1.5rem;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s;
        }

        .dot.active {
            background: #fff;
            transform: scale(1.3);
        }

        #loading-screen {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease;
        }

        .record-spin {
            animation: spin 10s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .gift-shake {
            animation: shake 0.2s ease-in-out infinite;
        }

        @keyframes shake {

            0%,
            100% {
                transform: rotate(-3deg);
            }

            50% {
                transform: rotate(3deg);
            }
        }

        .gift-pop {
            transform: scale(3) !important;
            opacity: 0 !important;
            transition: all 0.4s ease-in !important;
        }

        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, transparent, #fff, transparent);
            box-shadow: 0 0 20px #fff;
            animation: scan 2s linear infinite;
            display: none;
        }

        section.active .scan-line {
            display: block;
        }

        @keyframes scan {
            0% {
                top: 0%;
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                top: 100%;
                opacity: 0;
            }
        }

        .result-content {
            opacity: 0;
            transition: opacity 0.5s ease-out;
        }

        section.active .result-content {
            animation: reveal-final 0.5s forwards;
            animation-delay: 2.5s;
        }

        @keyframes reveal-final {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Post-it Wall Styles */
        .postit {
            width: 180px;
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            position: relative;
            transform: rotate(var(--rotation, -2deg));
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .postit-yellow {
            background: #ffef7d;
            --rotation: -2deg;
        }

        .postit-pink {
            background: #ff7eb9;
            --rotation: 3deg;
        }

        .postit-blue {
            background: #7afcff;
            --rotation: -1deg;
        }

        .postit-green {
            background: #98ff98;
            --rotation: 2deg;
        }

        .postit:hover {
            transform: rotate(0deg) scale(1.1);
            z-index: 10;
        }

        .wiggle-animation {
            animation: wiggle 0.5s ease-in-out;
        }

        @keyframes wiggle {

            0%,
            100% {
                transform: rotate(0deg) scale(1.1);
            }

            25% {
                transform: rotate(-5deg) scale(1.1);
            }

            75% {
                transform: rotate(5deg) scale(1.1);
            }
        }
    </style>
</head>

<body class="bg-black">

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mb-4"></div>
        <p class="font-bold uppercase tracking-[0.2em] text-[10px] opacity-70 text-white">Wird vorbereitet...</p>
    </div>

    <!-- Progress Bars -->
    <div class="progress-container" id="progressBarWrapper"></div>

    <!-- Gallery Modal -->
    <div id="gallery-modal"
        class="fixed inset-0 z-[200] bg-black/98 backdrop-blur-2xl hidden items-center justify-center p-4">
        <button id="close-modal"
            class="absolute top-6 right-6 p-3 bg-white/10 rounded-full z-[210] border border-white/10 active:scale-90 transition-transform">
            <i data-lucide="x" class="w-6 h-6 text-white"></i>
        </button>
        <div class="max-w-5xl w-full max-h-[85vh] overflow-y-auto px-4 py-10">
            <h2 id="modal-title" class="text-3xl font-black italic uppercase text-center mb-8 text-white">
                Abenteuer-Bilder</h2>
            <div id="modal-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 text-white"></div>
        </div>
    </div>

    <!-- Dynamic Transition Helper -->
    {% set ns = namespace(found=false, next_color='#f093fb') %}
    {% set section_order = [
    ('birthday', config.get('show_birthday', 'true') == 'true', '#8e2de2'),
    ('stats', config.get('show_stats', 'true') == 'true', '#ff416c'),
    ('chat', config.get('show_whatsapp', 'true') == 'true', '#00b4db'),
    ('wa_cards', config.get('show_whatsapp', 'true') == 'true', '#111b21'),
    ('thennow', config.get('show_development', 'true') == 'true', '#2af598'),
    ('chaos', config.get('show_chaos', 'true') == 'true', '#FFD200'),
    ('music', config.get('show_music', 'true') == 'true', '#4facfe'),
    ('travel', config.get('show_highlights', 'true') == 'true', '#000000'),
    ('bucket', config.get('show_bucketlist', 'true') == 'true', '#667eea'),
    ('wall', config.get('show_postits', 'true') == 'true', '#09090b'),
    ('profile', config.get('show_character', 'true') == 'true', '#f953c6'),
    ('finale', true, '#f093fb')
    ] %}

    {% macro get_next_color(current_id) %}
    {% set inner_ns = namespace(found=false, color='#000000', done=false) %}
    {% for sid, show, color in section_order %}
    {% if sid == current_id %}
    {% set inner_ns.found = true %}
    {% elif inner_ns.found and show and not inner_ns.done %}
    {% set inner_ns.color = color %}
    {% set inner_ns.done = true %}
    {% endif %}
    {% endfor %}
    {{ inner_ns.color }}
    {% endmacro %}

    <!-- 1. Intro -->
    <section class="wrapped-gradient-1" data-index="0">
        <div class="blob w-64 h-64 bg-green-400 left-[-10%] top-[-10%]"></div>
        <div class="blob w-96 h-96 bg-black bottom-[-10%] right-[-10%]" style="animation-delay: -5s"></div>
        <div class="relative z-10 text-center px-6 reveal active">
            <h2 class="text-sm font-black uppercase tracking-[0.4em] mb-4 opacity-70 stagger-1 text-white">Friendship
                Wrapped</h2>
            <h1 class="text-7xl md:text-[10rem] font-black mb-6 tracking-tighter leading-none text-white stagger-2">{{
                config.get('title_main', 'UNSERE<br>STORY')|safe }}</h1>
            <p class="text-base md:text-xl opacity-80 font-bold italic mb-8 stagger-3 text-white">{{
                config.get('intro_text', 'Bereit f√ºr eine Zeitreise durch unsere Freundschaft?') }}</p>
            <div class="animate-bounce opacity-30 mt-10 stagger-4"><i data-lucide="chevron-down"
                    class="mx-auto w-8 h-8 text-white"></i></div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 120" fill="none" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"
                class="w-full h-[60px] md:h-[120px]">
                <path d="M0 0C240 80 1200 80 1440 0V120H0V0Z" fill="{{ get_next_color('intro')|trim }}" />
            </svg>
        </div>
    </section>

    <!-- 2. Happy Birthday -->
    {% if config.get('show_birthday', 'true') == 'true' %}
    <section class="wrapped-gradient-birthday" data-index="1">
        <div class="bg-floating-text opacity-5 select-none stagger-1" style="left: -10%; top: 10%;">{{
            config.get('birthday_age', '19') }}</div>

        <!-- Floating BG Numbers -->
        {% set age = config.get('birthday_age', '19') %}
        <div class="absolute inset-0 overflow-hidden pointer-events-none birthday-stagger">
            <div class="floating-number text-[20rem] top-[-10%] left-[5%]" style="animation-delay: 0s;">{{ age }}</div>
            <div class="floating-number text-[15rem] bottom-[10%] right-[10%]" style="animation-delay: -3s;">{{ age }}
            </div>
            <div class="floating-number text-[10rem] top-[40%] left-[60%]" style="animation-delay: -7s;">{{ age }}</div>
            <div class="floating-number text-[12rem] bottom-[-5%] left-[20%]" style="animation-delay: -11s;">{{ age }}
            </div>
        </div>

        <div class="blob w-72 h-72 bg-pink-300 top-10 right-10"></div>
        <div class="blob w-96 h-96 bg-purple-600 bottom-0 left-[-10%]" style="animation-delay: -8s"></div>
        <div class="relative z-10 text-center px-6 reveal py-12">
            <h2 class="text-4xl md:text-7xl font-black mb-6 italic uppercase tracking-tighter stagger-1 text-white">
                {{ config.get('birthday_title', 'HAPPY BIRTHDAY!') }}</h2>
            <div
                class="inline-block px-10 py-4 bg-white/20 backdrop-blur-xl rounded-full mb-6 md:mb-8 stagger-2 border border-white/30 text-white">
                <span class="text-3xl font-black">{{ config.get('birthday_age', '19') }}.</span>
            </div>
            <p class="text-lg md:text-2xl font-bold opacity-80 max-w-xl mx-auto stagger-3 leading-relaxed text-white">
                {{ config.get('birthday_text', 'Heute feiern wir dich und all die Jahre, die wir uns schon kennen!') }}
            </p>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('birthday')|trim }}" fill-opacity="1"
                    d="M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,224C672,245,768,267,864,250.7C960,235,1056,181,1152,165.3C1248,149,1344,171,1392,181.3L1440,192L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 3. Overall Stats -->
    {% if config.get('show_stats', 'true') == 'true' %}
    <section class="wrapped-gradient-stats" data-index="2">
        <div class="bg-floating-text" style="right: -20%; bottom: 0%;">STATS</div>
        <div class="blob w-96 h-96 bg-white/10 left-[-10%] top-10"></div>
        <div class="relative z-10 reveal text-center px-6 py-12">
            <h2 class="text-5xl md:text-9xl font-black mb-4 tracking-tighter italic uppercase stagger-1 text-white">
                {{ config.get('stats_title', 'UNSERE ZEIT') }}</h2>
            <div class="flex items-center justify-center gap-4 md:gap-8 mb-8 stagger-2 text-white">
                <div class="text-center">
                    <span class="text-6xl md:text-8xl font-black count-up"
                        data-target="{{ config.get('years_count', '5') }}">0</span>
                    <p class="text-[10px] font-bold uppercase opacity-50">Jahre</p>
                </div>
                <div class="w-px h-16 bg-white/20"></div>
                <div class="text-center">
                    <span class="text-6xl md:text-8xl font-black count-up"
                        data-target="{{ config.get('days_count', '1825') }}">0</span>
                    <p class="text-[10px] font-bold uppercase opacity-50">Tage</p>
                </div>
            </div>
            <p class="text-base md:text-xl font-bold opacity-60 italic stagger-3 text-white">
                {{ config.get('stats_subtitle', 'Tage voller Erinnerungen und Abenteuer') }}</p>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('stats')|trim }}" fill-opacity="1"
                    d="M0,192L60,197.3C120,203,240,213,360,192C480,171,600,117,720,117.3C840,117,960,171,1080,186.7C1200,203,1320,181,1380,170.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 4. Chat Stats -->
    {% if config.get('show_whatsapp', 'true') == 'true' %}
    <section class="wrapped-gradient-chat" data-index="3">
        <div class="bg-floating-text" style="left: -10%; top: 20%;">CHAT</div>
        <div class="blob w-72 h-72 bg-blue-300 top-10 left-10"></div>
        <div class="relative z-10 text-center px-6 reveal w-full max-w-4xl text-white py-12">
            <h2
                class="text-3xl md:text-5xl font-black mb-8 md:mb-12 italic uppercase tracking-tighter stagger-1 flex items-center justify-center gap-4">
                {{ config.get('chat_stats_title', 'Einfach unzertrennlich') }}
            </h2>
            <div class="flex flex-wrap justify-center gap-4 md:gap-6 stagger-2">
                {% for line in config.get('chat_stats_config', '').split('\n') %}
                {% if line.strip() %}
                {% set parts = line.split('|') %}
                {% if parts|length >= 3 %}
                <div class="glass p-6 md:p-8 hover:scale-105 transition-transform w-[calc(50%-1rem)] md:w-72">
                    <i data-lucide="{{ parts[0].strip() }}"
                        class="w-6 h-6 md:w-8 md:h-8 mb-3 md:mb-4 mx-auto opacity-50"></i>
                    <h3 class="text-3xl md:text-4xl font-black mb-1 md:mb-2">
                        <span class="count-up" data-target="{{ parts[1].strip() }}">0</span>
                    </h3>
                    <p class="text-[9px] md:text-[10px] font-black uppercase opacity-60">{{ parts[2].strip() }}</p>
                </div>
                {% endif %}
                {% endif %}
                {% endfor %}
            </div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('chat')|trim }}" fill-opacity="1"
                    d="M0,64L48,80C96,96,192,128,288,128C384,128,480,96,576,106.7C672,117,768,171,864,176C960,181,1056,139,1152,122.7C1248,107,1344,117,1392,122.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 5. WhatsApp Cards -->
    {% if config.get('show_whatsapp', 'true') == 'true' %}
    <section class="bg-[#111b21] overflow-hidden" data-index="4">
        <div class="blob w-96 h-96 bg-emerald-500/10 right-[-10%] top-[-10%]"></div>
        <div class="relative z-10 w-full max-w-lg px-6 reveal py-12">
            <div class="mb-8 md:mb-12 text-center stagger-1">
                <div class="inline-block p-1 bg-white/10 rounded-2xl mb-4 backdrop-blur-xl border border-white/20">
                    <div class="px-4 py-2 bg-emerald-500/20 rounded-xl text-emerald-400 font-bold text-xs uppercase">
                        WhatsApp Wrapped</div>
                </div>
                <h2 class="text-3xl md:text-5xl font-black italic uppercase tracking-tighter text-white">
                    {{ config.get('wa_title', 'DEINE LEGEND√ÑREN NACHRICHTEN') }}</h2>
            </div>

            <div class="space-y-4">
                {% for msg in config.get('wa_messages', '').split('\n') %}
                {% if msg.strip() %}
                <div class="wa-card bg-[#202c33] p-6 rounded-[2rem] border border-white/5 shadow-2xl stagger-{{ loop.index + 1 }} hover:bg-[#2a3942] transition-colors group flex items-start gap-4"
                    style="transform: translateX({{ '30px' if loop.index % 2 == 0 else '-30px' }})">
                    <div class="flex-1">
                        <p
                            class="text-lg font-medium text-white group-hover:scale-105 transition-transform duration-500">
                            "{{ msg }}"</p>
                        <div class="mt-4 flex items-center justify-end opacity-40">
                            <div class="flex items-center gap-1">
                                <span class="text-[10px] font-bold mr-2 text-white">22:31</span>
                                <i data-lucide="check-check" class="w-3 h-3 text-[#53bdeb]"></i>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        <div class="curve-divider curve-bottom text-white">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('wa_cards')|trim }}" fill-opacity="1"
                    d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,213.3C1248,235,1344,213,1392,202.7L1440,192L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 6. Damals vs Heute -->
    {% if config.get('show_development', 'true') == 'true' %}
    <section class="wrapped-gradient-thennow" data-index="5">
        <div class="blob w-80 h-80 bg-cyan-200 right-[-10%] bottom-0"></div>
        <div class="relative z-10 w-full flex flex-col items-center reveal h-full py-12 text-white">
            <h2
                class="text-3xl md:text-6xl font-black mb-6 text-center italic uppercase tracking-tighter px-6 stagger-1 text-white">
                {{ config.get('development_title', 'Die Entwicklung') }}</h2>
            <div class="swipe-container h-[60vh] md:h-[70vh] stagger-2" id="thenNowSwipe">
                <div class="swipe-item">
                    <div class="relative max-w-[85vw] md:max-w-2xl h-full w-full">
                        <div
                            class="absolute top-2 left-2 bg-white text-black font-black px-4 py-1 rounded-full z-20 text-xs shadow-lg">
                            Damals</div>
                        <div
                            class="h-full w-full rounded-[2.5rem] overflow-hidden border-4 border-white/20 shadow-2xl bg-zinc-900">
                            <img src="{{ config.get('img_then', 'https://images.unsplash.com/photo-1543269865-cbf427effbad?w=800') }}"
                                class="w-full h-full object-cover">
                        </div>
                    </div>
                </div>
                <div class="swipe-item">
                    <div class="relative max-w-[85vw] md:max-w-2xl h-full w-full">
                        <div
                            class="absolute top-2 left-2 bg-pink-500 text-white font-black px-4 py-1 rounded-full z-20 text-xs shadow-lg">
                            Heute</div>
                        <div
                            class="h-full w-full rounded-[2.5rem] overflow-hidden border-4 border-white/20 shadow-2xl bg-zinc-900">
                            <img src="{{ config.get('img_now', 'https://images.unsplash.com/photo-1529156069898-49953e39b3ac?w=800') }}"
                                class="w-full h-full object-cover">
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-6 flex flex-col items-center gap-3 stagger-3">
                <div class="flex gap-2" id="swipeDots">
                    <div class="dot active"></div>
                    <div class="dot"></div>
                </div>
                <p
                    class="text-[10px] font-black uppercase tracking-[0.3em] opacity-60 text-white flex items-center gap-2 bg-black/20 px-3 py-1 rounded-full">
                    <i data-lucide="arrow-left" class="w-3 h-3 text-white"></i> Swipe <i data-lucide="arrow-right"
                        class="w-3 h-3 text-white"></i>
                </p>
            </div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 120" fill="none" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"
                class="w-full h-[60px] md:h-[120px]">
                <path d="M0 0C360 100 1080 100 1440 0V120H0V0Z" fill="{{ get_next_color('thennow')|trim }}" />
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 7. Meme-Galerie (Anklickbar & Staggered) -->
    {% if config.get('show_chaos', 'true') == 'true' %}
    <section class="wrapped-gradient-funny overflow-hidden" data-index="6">
        <!-- Floating Chaos Elements -->
        <div class="absolute inset-0 pointer-events-none opacity-20">
            <div class="absolute top-1/4 left-1/4 text-6xl animate-bounce" style="animation-duration: 3s;">ü§™</div>
            <div class="absolute bottom-1/3 right-1/4 text-5xl animate-pulse" style="animation-duration: 4s;">‚ú®</div>
            <div class="absolute top-1/3 right-10 text-4xl -rotate-12">üî•</div>
            <div class="absolute bottom-10 left-1/2 text-6xl rotate-12">üòÇ</div>
        </div>

        <div class="relative z-10 w-full max-w-6xl px-6">
            <div class="reveal text-center mb-16">
                <h2 class="text-4xl md:text-7xl font-black mb-4 italic uppercase tracking-tighter text-black stagger-1">
                    {{ config.get('chaos_title', 'Unsere Chaos-Momente') }}</h2>
                <div class="h-2 w-24 bg-black mx-auto rounded-full opacity-20 stagger-2"></div>
            </div>

            <div class="relative h-[500px] md:h-[600px] w-full flex items-center justify-center">
                <!-- Scattered Polaroid Gallery -->
                <div class="relative w-full max-w-4xl h-full flex items-center justify-center">
                    {% set meme_imgs = config.get('gallery_memes', '').split(',') %}
                    {% set positions = [
                    'left-[5%] top-[5%] md:left-[15%]',
                    'right-[5%] top-[10%] md:right-[20%]',
                    'bottom-[5%] left-[10%] md:left-[25%]',
                    'bottom-[5%] right-[5%] md:right-[20%]',
                    'top-[40%] left-[10%] md:left-[5%]',
                    'top-[20%] right-[10%] md:right-[5%]'
                    ] %}
                    {% set rotations = [-6, 4, 12, -12, 8, -5] %}
                    {% set tape_rotations = [-3, 6, -12, 2, 5, -8] %}

                    {% for img in meme_imgs %}
                    {% if img.strip() %}
                    {% set idx = loop.index0 % 6 %}
                    <div onclick="openGallery('memes')"
                        class="reveal stagger-{{ loop.index + 1 }} absolute {{ positions[idx] }} group cursor-pointer z-[{{ 10 + loop.index }}]">
                        <div
                            class="absolute -top-6 left-1/2 -translate-x-1/2 w-16 h-8 bg-black/10 backdrop-blur-sm {{ 'rotate-[' ~ tape_rotations[idx] ~ 'deg]' }} z-20">
                        </div>
                        <div class="w-40 h-52 md:w-56 md:h-72 bg-[#fdfdfd] p-3 pb-12 shadow-[20px_20px_60px_rgba(0,0,0,0.15)] rounded-sm transition-all duration-500 border border-black/5 group-hover:rotate-0 group-hover:scale-110 group-hover:z-50"
                            style="transform: rotate({{ rotations[idx] }}deg)">
                            <div class="w-full h-full overflow-hidden bg-zinc-200 rounded-sm">
                                <img src="{{ img.strip() }}"
                                    class="w-full h-full object-cover grayscale transition-all duration-700 group-hover:grayscale-0">
                            </div>
                            <p
                                class="absolute bottom-3 left-0 w-full text-center font-['Inter'] font-black text-xs md:text-sm text-black/40 italic">
                                {{ ['#CHAOS', 'VIBES ‚ö°Ô∏è', 'LEGEND√ÑR', 'UNS', 'MEMORIES', 'STORY'][idx] }}
                            </p>
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 120" fill="none" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"
                class="w-full h-[60px] md:h-[120px]">
                <path d="M0 0C360 120 1080 120 1440 0V120H0V0Z" fill="{{ get_next_color('chaos')|trim }}" />
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 8. Musik -->
    {% if config.get('show_music', 'true') == 'true' %}
    <section class="wrapped-gradient-music" data-index="7">
        <div class="bg-floating-text" style="right: -10%; top: 10%;">MUSIC</div>
        <div class="blob w-96 h-96 bg-cyan-200 top-[-10%] left-[-10%]"></div>
        <div class="relative z-10 text-center px-6 reveal">
            <h2
                class="text-4xl md:text-7xl font-black mb-12 italic uppercase text-white tracking-tighter stagger-1 text-white">
                {{ config.get('music_title', 'Euer All-Time Favorit') }}</h2>
            <div class="glass p-10 inline-block max-w-[340px] w-full text-left stagger-2 group">
                <div
                    class="record-spin mb-10 mx-auto w-48 h-48 rounded-full bg-zinc-900 border-[10px] border-zinc-800 flex items-center justify-center relative shadow-2xl group-hover:scale-110 transition-transform duration-700">
                    <div class="w-10 h-10 rounded-full bg-black border-2 border-zinc-700 z-10"></div>
                    <img src="{{ config.get('song_cover', '') }}"
                        class="absolute inset-4 rounded-full opacity-40 object-cover">
                </div>
                <div class="space-y-1">
                    <p class="text-[10px] font-black uppercase text-cyan-200 tracking-[0.3em] stagger-3">{{
                        config.get('song_artist', 'Dauerschleife') }}</p>
                    <h3 class="text-3xl font-black italic tracking-tighter text-white leading-tight stagger-4">{{
                        config.get('song_title', 'Friendship Anthem') }}</h3>
                </div>
            </div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('music')|trim }}" fill-opacity="1"
                    d="M0,256L60,240C120,224,240,192,360,197.3C480,203,600,245,720,245.3C840,245,960,203,1080,181.3C1200,160,1320,160,1380,160L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 9. Paris Trip -->
    {% if config.get('show_highlights', 'true') == 'true' %}
    <section id="trip1" class="bg-black gradient-animate" data-index="8">
        <div class="bg-floating-text" style="left: 0%; top: 30%;">TRAVEL</div>
        <div class="trip-bg-overlay" style="background-image: url('{{ config.get('trip_bg', '') }}');">
        </div>
        <div class="relative z-10 w-full px-6 flex flex-col lg:flex-row items-center gap-10 max-w-6xl reveal">
            <div class="w-full lg:w-1/2 stagger-1 text-white">
                <div class="glass p-10 md:p-14">
                    <span class="text-pink-400 font-black uppercase text-[10px] tracking-[0.4em] mb-4 block italic">{{
                        config.get('highlight_label', 'Das Highlight') }}</span>
                    <h3 class="text-5xl md:text-7xl font-black mb-8 italic uppercase text-white leading-none">
                        {{ config.get('trip_city', 'Abenteuer') }}</h3>
                    <button onclick="openGallery('paris')"
                        class="bg-white text-black px-8 py-4 rounded-full font-black uppercase text-xs flex items-center gap-3 active:scale-95 transition-all shadow-2xl hover:bg-pink-50 transition-colors"><i
                            data-lucide="images" class="w-5 h-5"></i> Galerie ansehen</button>
                </div>
            </div>
            <div class="w-full lg:w-1/2 flex justify-center stagger-2">
                <div class="relative group cursor-pointer" onclick="openGallery('paris')">
                    <div
                        class="absolute -inset-4 bg-pink-500 blur-2xl opacity-20 group-hover:opacity-40 transition duration-700">
                    </div>
                    <img src="{{ config.get('trip_bg', '') }}"
                        class="relative rounded-[3rem] shadow-2xl border-8 border-white/10 object-cover aspect-square max-w-[280px] md:max-w-md rotate-3 transition-transform duration-700 group-hover:rotate-0 group-hover:scale-105">
                    <div
                        class="absolute -bottom-6 -right-6 bg-pink-500 p-5 rounded-2xl shadow-2xl rotate-12 group-hover:rotate-0 transition-transform">
                        <i data-lucide="heart" class="text-white w-6 h-6 fill-current"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('travel')|trim }}" fill-opacity="1"
                    d="M0,160L48,144C96,128,192,96,288,106.7C384,117,480,171,576,186.7C672,203,768,181,864,154.7C960,128,1056,96,1152,90.7C1248,85,1344,107,1392,117.3L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 10. Bucket List -->
    {% if config.get('show_bucketlist', 'true') == 'true' %}
    <section class="wrapped-gradient-future" data-index="9">
        <div class="bg-floating-text" style="right: -10%; top: 10%;">GOALS</div>
        <div class="blob w-72 h-72 bg-blue-400 left-[-5%] top-[-5%]"></div>
        <div class="relative z-10 text-center px-6 reveal w-full max-w-4xl stagger-1 text-white py-12">
            <h2
                class="text-5xl md:text-8xl font-black italic uppercase mb-12 tracking-tighter leading-none text-white text-white">
                {{ config.get('bucket_title', 'Was wir noch erleben') }}</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {% for item in config.get('bucket_items', '').split('\n') %}
                {% if item.strip() %}
                {% set parts = item.split('|') %}
                <div
                    class="glass p-8 flex items-center gap-6 text-left reveal-item stagger-{{ loop.index + 1 }} group hover:bg-white/20 transition-colors">
                    <div class="bg-white/20 p-5 rounded-[2rem] group-hover:rotate-12 transition-transform shadow-xl">
                        <i data-lucide="{{ parts[0] if parts|length > 0 else 'star' }}" class="w-8 h-8 text-white"></i>
                    </div>
                    <div>
                        <p class="text-[10px] font-black opacity-50 uppercase text-white tracking-widest">{{ parts[1] if
                            parts|length > 1 else 'Ziel' }}</p>
                        <p class="text-2xl font-black italic text-white">{{ parts[2] if parts|length > 2 else 'Bucket
                            List Item' }}</p>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('bucket')|trim }}" fill-opacity="1"
                    d="M0,128L48,144C96,160,192,192,288,208C384,224,480,224,576,213.3C672,203,768,181,864,186.7C960,192,1056,224,1152,213.3C1248,203,1344,149,1392,122.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 11. Post-it Wall -->
    {% if config.get('show_postits', 'true') == 'true' %}
    <section class="bg-zinc-950" data-index="10">
        <div class="bg-floating-text" style="left: -10%; bottom: 10%;">WALL</div>
        <div class="blob w-80 h-80 bg-yellow-400/10 left-[-10%] top-[-10%]"></div>
        <div class="relative z-10 w-full max-w-5xl px-6 py-20 text-center reveal">
            <h2 class="text-3xl md:text-6xl font-black mb-16 italic uppercase tracking-tighter text-white stagger-1">
                {{ config.get('postits_title', 'Was ich an dir sch√§tze') }}</h2>
            <div class="flex flex-wrap justify-center gap-10">
                {% set colors = ['postit-yellow', 'postit-pink', 'postit-blue', 'postit-green'] %}
                {% for note in config.get('postits_content', '').split(',') %}
                {% if note %}
                <div class="postit {{ colors[loop.index0 % 4] }} shadow-2xl cursor-pointer hover:scale-110 active:scale-95 transition-all reveal-item stagger-{{ loop.index + 1 }}"
                    onclick="this.classList.add('wiggle-animation'); setTimeout(() => this.classList.remove('wiggle-animation'), 500)">
                    <p class="text-black font-black italic text-lg md:text-xl leading-tight select-none">{{
                        note.strip() }}</p>
                    <!-- Pin effect -->
                    <div
                        class="absolute top-3 left-1/2 -translate-x-1/2 w-4 h-4 bg-red-600 rounded-full shadow-inner opacity-60">
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        <div class="curve-divider curve-bottom">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('wall')|trim }}" fill-opacity="1"
                    d="M0,192L48,176C96,160,192,128,288,138.7C384,149,480,203,576,197.3C672,192,768,128,864,128C960,128,1056,192,1152,208C1248,224,1344,192,1392,176L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 12. Reveal Charakter -->
    {% if config.get('show_character', 'true') == 'true' %}
    <section class="wrapped-gradient-profile" data-index="11" id="profile-reveal-section">
        <div class="bg-floating-text" style="right: -10%; top: 20%;">ULTIMATE</div>
        <div class="blob w-96 h-96 bg-white/20 top-0 right-[-10%]"></div>
        <div class="relative z-10 text-center px-6 reveal w-full max-w-lg py-12">
            <div id="analyzing-state" class="mb-14 transition-opacity duration-500">
                <div
                    class="w-24 h-24 border-8 border-white/20 border-t-white rounded-full animate-spin mx-auto mb-8 shadow-2xl">
                </div>
                <p class="text-lg font-black uppercase tracking-[0.5em] opacity-80 text-white italic animate-pulse">
                    {{ config.get('analyzing_text', 'Extracting Vibes...') }}
                </p>
            </div>

            <div id="character-result"
                class="hidden opacity-0 flex flex-col items-center scale-75 blur-lg transition-all duration-1000">
                <div class="relative mb-12">
                    <div class="absolute -inset-10 bg-white blur-[100px] opacity-30 animate-pulse"></div>
                    <div
                        class="relative w-56 h-56 bg-white rounded-[3rem] rotate-6 flex items-center justify-center shadow-2xl overflow-hidden ring-4 ring-white/50 group hover:rotate-0 transition-transform duration-500">
                        <div class="text-8xl group-hover:scale-125 transition-transform duration-500">üëë</div>
                    </div>
                </div>
                <span class="text-xs font-black uppercase tracking-[0.6em] mb-4 opacity-70 text-white">{{
                    config.get('character_type_label', 'Charakter-Typ') }}</span>
                <h2
                    class="text-6xl md:text-8xl font-black italic uppercase tracking-tighter text-white mb-10 leading-none">
                    {{ config.get('character_type', 'Elite-Bestie') }}</h2>
                <div class="px-8 py-3 bg-black/30 backdrop-blur-xl rounded-2xl border border-white/20">
                    <p class="text-3xl font-black text-white lowercase italic">#{{ config.get('character_name', 'Simon')
                        }}Style</p>
                </div>
            </div>
        </div>
        <div class="curve-divider curve-bottom text-white">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-24 md:h-40">
                <path fill="{{ get_next_color('profile')|trim }}" fill-opacity="1"
                    d="M0,256L60,240C120,224,240,192,360,197.3C480,203,600,245,720,245.3C840,245,960,203,1080,181.3C1200,160,1320,160,1380,160L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                </path>
            </svg>
        </div>
    </section>
    {% endif %}

    <!-- 13. Finale -->
    <section class="wrapped-gradient-4" data-index="12">
        <div class="blob w-80 h-80 bg-pink-400 left-[-10%] bottom-[-10%] text-white"></div>
        <div class="relative z-10 text-center px-6 reveal">
            <div id="gift-box" class="cursor-pointer group inline-block">
                <div id="gift-visual"
                    class="bg-white p-10 rounded-[3rem] shadow-2xl relative transition-all duration-300 hover:rotate-2">
                    <div id="gift-label"
                        class="absolute -top-4 -right-4 bg-pink-600 text-white text-[10px] font-black px-4 py-2 rounded-full animate-bounce uppercase shadow-lg">
                        √ñffnen</div>
                    <i data-lucide="gift" class="w-16 h-16 text-pink-500 mx-auto"></i>
                </div>
            </div>
            <div id="final-message" class="hidden">
                <h2
                    class="text-5xl md:text-[8rem] font-black mb-6 italic uppercase leading-none tracking-tighter text-white">
                    {{ config.get('final_msg_title', 'Bestie Forever.') }}</h2>
                <p class="text-lg md:text-2xl opacity-90 font-bold max-w-xl mx-auto mb-10 text-white italic">
                    {{ config.get('final_msg_text', 'Danke f√ºr jeden einzelnen Moment. Du bist Familie. Auf ewig!') }}
                </p>
                <p class="text-3xl font-black italic uppercase text-pink-100 text-white">{{
                    config.get('final_sender_name', 'Dein Bestie') }}</p>
            </div>
        </div>
    </section>

    <footer
        class="py-12 bg-black text-center text-[10px] font-black tracking-[0.5em] opacity-30 uppercase flex items-center justify-center text-white">
        Memory Wrapped ‚Ä¢ Unsere Story
    </footer>

    <script>
        lucide.createIcons();

        // Bilder f√ºr die Galerien - Normally this would be dynamic too, but for now hardcoded demo images are fine or fallback
        // Since the user asked to edit "content", I replaced the main ones. Galleries are complex to edit in a flat config.
        // Bilder f√ºr die Galerien
        const tripGalleries = {
            paris: {
                title: "{{ config.get('trip_city', 'Abenteuer') }}",
                images: "{{ config.get('gallery_paris', '') }}".split(',').filter(x => x)
            },
            memes: {
                title: "Chaos-Momente",
                images: "{{ config.get('gallery_memes', '') }}".split(',').filter(x => x)
            }
        };

        const totalSections = document.querySelectorAll('section').length;
        const progressWrapper = document.getElementById('progressBarWrapper');
        progressWrapper.innerHTML = Array(totalSections).fill('<div class="progress-bar"><div class="progress-fill"></div></div>').join('');

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    const idx = entry.target.getAttribute('data-index');
                    if (idx !== null) updateProgress(parseInt(idx));

                    entry.target.querySelectorAll('.reveal').forEach(r => r.classList.add('active'));
                    entry.target.querySelectorAll('.count-up').forEach(c => { if (!c.dataset.counted) { c.dataset.counted = true; animateCountUp(c); } });

                    if (entry.target.id === 'profile-reveal-section' && !entry.target.dataset.revealed) {
                        entry.target.dataset.revealed = "true";
                        handleProfileReveal();
                    }
                }
            });
        }, { threshold: 0.3 });

        document.querySelectorAll('section').forEach(s => observer.observe(s));

        function updateProgress(activeIndex) {
            document.querySelectorAll('.progress-fill').forEach((bar, i) => { bar.style.width = i < activeIndex ? '100%' : (i === activeIndex ? '100%' : '0%'); });
        }

        const swipeContainer = document.getElementById('thenNowSwipe');
        const dots = document.querySelectorAll('#swipeDots .dot');
        if (swipeContainer) {
            swipeContainer.addEventListener('scroll', () => {
                const index = Math.round(swipeContainer.scrollLeft / swipeContainer.clientWidth);
                dots.forEach((dot, i) => dot.classList.toggle('active', i === index));
            });
        }

        function animateCountUp(el) {
            const target = parseInt(el.dataset.target);
            let count = 0;
            const inc = target / 60;
            const timer = setInterval(() => {
                count += inc;
                if (count >= target) { el.innerText = target.toLocaleString(); clearInterval(timer); }
                else { el.innerText = Math.floor(count).toLocaleString(); }
            }, 16);
        }

        function handleProfileReveal() {
            const analyzing = document.getElementById('analyzing-state');
            const result = document.getElementById('character-result');
            setTimeout(() => {
                analyzing.style.opacity = '0';
                setTimeout(() => {
                    analyzing.classList.add('hidden');
                    result.classList.remove('hidden');
                    setTimeout(() => {
                        result.classList.remove('opacity-0', 'scale-75', 'blur-lg');
                        result.classList.add('opacity-1', 'scale-100', 'blur-0');
                        confetti({
                            particleCount: 150,
                            spread: 70,
                            origin: { y: 0.6 },
                            colors: ['#f953c6', '#b91d73', '#ffffff']
                        });
                    }, 100);
                }, 500);
            }, 2500);
        }

        function openGallery(id) {
            const data = tripGalleries[id];
            if (!data) return;
            document.getElementById('modal-title').innerText = data.title;
            document.getElementById('modal-grid').innerHTML = data.images.map(img => `<div class="aspect-square rounded-2xl overflow-hidden bg-zinc-900 shadow-lg"><img src="${img}" class="w-full h-full object-cover"></div>`).join('');
            const modal = document.getElementById('gallery-modal');
            modal.classList.remove('hidden'); modal.classList.add('flex');
            document.body.style.overflow = 'hidden'; document.documentElement.style.scrollSnapType = 'none';
        }

        document.getElementById('close-modal').onclick = () => {
            const modal = document.getElementById('gallery-modal');
            modal.classList.add('hidden'); modal.classList.remove('flex');
            document.body.style.overflow = ''; document.documentElement.style.scrollSnapType = 'y mandatory';
        };

        document.getElementById('gift-box').onclick = function () {
            const visual = document.getElementById('gift-visual');
            visual.classList.add('gift-shake');
            const end = Date.now() + 2000;
            (function frame() {
                confetti({ particleCount: 4, angle: 60, spread: 60, origin: { x: 0 }, colors: ['#ff416c', '#1db954', '#ffffff', '#8e2de2'] });
                confetti({ particleCount: 4, angle: 120, spread: 60, origin: { x: 1 }, colors: ['#ff416c', '#1db954', '#ffffff', '#8e2de2'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
            setTimeout(() => {
                visual.classList.add('gift-pop');
                setTimeout(() => { this.style.display = 'none'; document.getElementById('final-message').classList.remove('hidden'); document.getElementById('final-message').classList.add('reveal', 'active'); }, 300);
            }, 600);
        };

        window.onload = () => {
            setTimeout(() => {
                const loader = document.getElementById('loading-screen');
                if (loader) { loader.style.opacity = '0'; setTimeout(() => loader.remove(), 500); }
            }, 1000);
        };
    </script>
</body>

</html>